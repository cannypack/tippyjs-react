{"version":3,"file":"tippy-react.umd.js","sources":["../src/utils.js","../src/util-hooks.js","../src/className-plugin.js","../src/Tippy.js","../src/useSingleton.js","../src/forwardRef.js","../src/index.js"],"sourcesContent":["export const isBrowser =\n  typeof window !== 'undefined' && typeof document !== 'undefined';\n\nexport function preserveRef(ref, node) {\n  if (ref) {\n    if (typeof ref === 'function') {\n      ref(node);\n    }\n    if ({}.hasOwnProperty.call(ref, 'current')) {\n      ref.current = node;\n    }\n  }\n}\n\nexport function ssrSafeCreateDiv() {\n  return isBrowser && document.createElement('div');\n}\n\nexport function toDataAttributes(attrs) {\n  const dataAttrs = {\n    'data-placement': attrs.placement,\n  };\n\n  if (attrs.referenceHidden) {\n    dataAttrs['data-reference-hidden'] = '';\n  }\n\n  if (attrs.escaped) {\n    dataAttrs['data-escaped'] = '';\n  }\n\n  return dataAttrs;\n}\n\nfunction deepEqual(x, y) {\n  if (x === y) {\n    return true;\n  } else if (\n    typeof x === 'object' &&\n    x != null &&\n    typeof y === 'object' &&\n    y != null\n  ) {\n    if (Object.keys(x).length !== Object.keys(y).length) {\n      return false;\n    }\n\n    for (const prop in x) {\n      if (y.hasOwnProperty(prop)) {\n        if (!deepEqual(x[prop], y[prop])) {\n          return false;\n        }\n      } else {\n        return false;\n      }\n    }\n\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function uniqueByShape(arr) {\n  const output = [];\n\n  arr.forEach(item => {\n    if (!output.find(outputItem => deepEqual(item, outputItem))) {\n      output.push(item);\n    }\n  });\n\n  return output;\n}\n\nexport function deepPreserveProps(instanceProps, componentProps) {\n  return {\n    ...componentProps,\n    popperOptions: {\n      ...instanceProps.popperOptions,\n      ...componentProps.popperOptions,\n      modifiers: uniqueByShape([\n        ...(instanceProps.popperOptions?.modifiers || []),\n        ...(componentProps.popperOptions?.modifiers || []),\n      ]),\n    },\n  };\n}\n","import {useRef} from 'react';\n\nexport function useMutableBox(initialValue) {\n  // Using refs instead of state as it's recommended to not store imperative\n  // values in state due to memory problems in React(?)\n  const ref = useRef();\n\n  if (!ref.current) {\n    ref.current =\n      typeof initialValue === 'function' ? initialValue() : initialValue;\n  }\n\n  return ref.current;\n}\n","function updateClassName(box, action, classNames) {\n  classNames.split(/\\s+/).forEach(name => {\n    if (name) {\n      box.classList[action](name);\n    }\n  });\n}\n\nexport const classNamePlugin = {\n  name: 'className',\n  defaultValue: '',\n  fn(instance) {\n    const box = instance.popper.firstElementChild;\n    const isDefaultRenderFn = () => !!instance.props.render?.$$tippy;\n\n    function add() {\n      if (instance.props.className && !isDefaultRenderFn()) {\n        if (process.env.NODE_ENV !== 'production') {\n          console.warn(\n            [\n              '@tippyjs/react: Cannot use `className` prop in conjunction with',\n              '`render` prop. Place the className on the element you are',\n              'rendering.',\n            ].join(' '),\n          );\n        }\n\n        return;\n      }\n\n      updateClassName(box, 'add', instance.props.className);\n    }\n\n    function remove() {\n      if (isDefaultRenderFn()) {\n        updateClassName(box, 'remove', instance.props.className);\n      }\n    }\n\n    return {\n      onCreate: add,\n      onBeforeUpdate: remove,\n      onAfterUpdate: add,\n    };\n  },\n};\n","import React, {cloneElement, useEffect, useState} from 'react';\nimport {createPortal} from 'react-dom';\nimport {\n  preserveRef,\n  ssrSafeCreateDiv,\n  toDataAttributes,\n  deepPreserveProps,\n} from './utils';\nimport {useMutableBox} from './util-hooks';\nimport {classNamePlugin} from './className-plugin';\n\nexport default function TippyGenerator(tippy) {\n  function Tippy({\n    children,\n    content,\n    visible,\n    singleton,\n    render,\n    reference,\n    disabled = false,\n    ignoreAttributes = true,\n    // Filter React development reserved props\n    // added by babel-preset-react dev plugins:\n    // transform-react-jsx-self and transform-react-jsx-source\n    __source,\n    __self,\n    ...restOfNativeProps\n  }) {\n    const isControlledMode = visible !== undefined;\n    const isSingletonMode = singleton !== undefined;\n\n    const [mounted, setMounted] = useState(false);\n    const [attrs, setAttrs] = useState({});\n    const [singletonContent, setSingletonContent] = useState();\n    const mutableBox = useMutableBox(() => ({\n      container: ssrSafeCreateDiv(),\n      renders: 1,\n    }));\n\n    const props = {\n      ignoreAttributes,\n      ...restOfNativeProps,\n      content: mutableBox.container,\n    };\n\n    if (isControlledMode) {\n      if (process.env.NODE_ENV !== 'production') {\n        ['trigger', 'hideOnClick', 'showOnCreate'].forEach(nativeStateProp => {\n          if (props[nativeStateProp] !== undefined) {\n            console.warn(\n              [\n                `@tippyjs/react: Cannot specify \\`${nativeStateProp}\\` prop in`,\n                `controlled mode (\\`visible\\` prop)`,\n              ].join(' '),\n            );\n          }\n        });\n      }\n\n      props.trigger = 'manual';\n      props.hideOnClick = false;\n    }\n\n    if (isSingletonMode) {\n      disabled = true;\n    }\n\n    let computedProps = props;\n    const plugins = props.plugins || [];\n\n    if (render) {\n      computedProps = {\n        ...props,\n        plugins:\n          isSingletonMode && singleton.data != null\n            ? [\n                ...plugins,\n                {\n                  fn() {\n                    return {\n                      onTrigger(instance, event) {\n                        const node = singleton.data.children.find(\n                          ({instance}) =>\n                            instance.reference === event.currentTarget,\n                        );\n                        instance.state.$$activeSingletonInstance =\n                          node.instance;\n                        setSingletonContent(node.content);\n                      },\n                    };\n                  },\n                },\n              ]\n            : plugins,\n        render: () => ({popper: mutableBox.container}),\n      };\n    }\n\n    const deps = [reference].concat(children ? [children.type] : []);\n\n    // CREATE\n    useEffect(() => {\n      let element = reference;\n      if (reference && reference.hasOwnProperty('current')) {\n        element = reference.current;\n      }\n\n      const instance = tippy(element || mutableBox.ref || ssrSafeCreateDiv(), {\n        ...computedProps,\n        plugins: [classNamePlugin, ...(props.plugins || [])],\n      });\n\n      mutableBox.instance = instance;\n\n      if (disabled) {\n        instance.disable();\n      }\n\n      if (visible) {\n        instance.show();\n      }\n\n      if (isSingletonMode) {\n        singleton.hook({\n          instance,\n          content,\n          props: computedProps,\n          setSingletonContent,\n        });\n      }\n\n      setMounted(true);\n\n      return () => {\n        instance.destroy();\n        singleton?.cleanup(instance);\n      };\n    }, deps);\n\n    // UPDATE\n    useEffect(() => {\n      // Prevent this effect from running on 1st render\n      if (mutableBox.renders === 1) {\n        mutableBox.renders++;\n        return;\n      }\n\n      const {instance} = mutableBox;\n\n      instance.setProps(deepPreserveProps(instance.props, computedProps));\n\n      // Fixes #264\n      instance.popperInstance?.forceUpdate();\n\n      if (disabled) {\n        instance.disable();\n      } else {\n        instance.enable();\n      }\n\n      if (isControlledMode) {\n        if (visible) {\n          instance.show();\n        } else {\n          instance.hide();\n        }\n      }\n\n      if (isSingletonMode) {\n        singleton.hook({\n          instance,\n          content,\n          props: computedProps,\n          setSingletonContent,\n        });\n      }\n    });\n\n    useEffect(() => {\n      if (!render) {\n        return;\n      }\n\n      const {instance} = mutableBox;\n\n      instance.setProps({\n        popperOptions: {\n          ...instance.props.popperOptions,\n          modifiers: [\n            ...(instance.props.popperOptions?.modifiers || []).filter(\n              ({name}) => name !== '$$tippyReact',\n            ),\n            {\n              name: '$$tippyReact',\n              enabled: true,\n              phase: 'beforeWrite',\n              requires: ['computeStyles'],\n              fn({state}) {\n                const hideData = state.modifiersData?.hide;\n\n                // WARNING: this is a high-risk path that can cause an infinite\n                // loop. This expression _must_ evaluate to false when required\n                if (\n                  attrs.placement !== state.placement ||\n                  attrs.referenceHidden !== hideData?.isReferenceHidden ||\n                  attrs.escaped !== hideData?.hasPopperEscaped\n                ) {\n                  setAttrs({\n                    placement: state.placement,\n                    referenceHidden: hideData?.isReferenceHidden,\n                    escaped: hideData?.hasPopperEscaped,\n                  });\n                }\n\n                state.attributes.popper = {};\n              },\n            },\n          ],\n        },\n      });\n    }, [attrs.placement, attrs.referenceHidden, attrs.escaped, ...deps]);\n\n    return (\n      <>\n        {children\n          ? cloneElement(children, {\n              ref(node) {\n                mutableBox.ref = node;\n                preserveRef(children.ref, node);\n              },\n            })\n          : null}\n        {mounted &&\n          createPortal(\n            render\n              ? render(\n                  toDataAttributes(attrs),\n                  singletonContent,\n                  mutableBox.instance,\n                )\n              : content,\n            mutableBox.container,\n          )}\n      </>\n    );\n  }\n\n  return Tippy;\n}\n","import {useMutableBox} from './util-hooks';\nimport {deepPreserveProps} from './utils';\nimport {classNamePlugin} from './className-plugin';\nimport {useEffect, useMemo, useState} from 'react';\n\nexport default function useSingletonGenerator(createSingleton) {\n  return function useSingleton({disabled = false, overrides = []} = {}) {\n    const [mounted, setMounted] = useState(false);\n    const mutableBox = useMutableBox({\n      children: [],\n      renders: 1,\n    });\n\n    useEffect(() => {\n      if (!mounted) {\n        setMounted(true);\n        return;\n      }\n\n      const {children, sourceData} = mutableBox;\n\n      if (!sourceData) {\n        if (process.env.NODE_ENV !== 'production') {\n          console.error(\n            [\n              '@tippyjs/react: The `source` variable from `useSingleton()` has',\n              'not been passed to a <Tippy /> component.',\n            ].join(' '),\n          );\n        }\n\n        return;\n      }\n\n      const instance = createSingleton(\n        children.map(child => child.instance),\n        {\n          ...sourceData.props,\n          popperOptions: sourceData.instance.props.popperOptions,\n          overrides,\n          plugins: [classNamePlugin, ...(sourceData.props.plugins || [])],\n        },\n      );\n\n      mutableBox.instance = instance;\n\n      if (disabled) {\n        instance.disable();\n      }\n\n      return () => {\n        instance.destroy();\n        mutableBox.children = children.filter(\n          ({instance}) => !instance.state.isDestroyed,\n        );\n      };\n    }, [mounted]);\n\n    useEffect(() => {\n      if (!mounted) {\n        return;\n      }\n\n      if (mutableBox.renders === 1) {\n        mutableBox.renders++;\n        return;\n      }\n\n      const {children, instance, sourceData} = mutableBox;\n\n      if (!(instance && sourceData)) {\n        return;\n      }\n\n      const {content, ...props} = sourceData.props;\n\n      instance.setProps(\n        deepPreserveProps(instance.props, {\n          ...props,\n          overrides,\n        }),\n      );\n\n      instance.setInstances(children.map(child => child.instance));\n\n      if (disabled) {\n        instance.disable();\n      } else {\n        instance.enable();\n      }\n    });\n\n    return useMemo(() => {\n      const source = {\n        data: mutableBox,\n        hook(data) {\n          mutableBox.sourceData = data;\n          mutableBox.setSingletonContent = data.setSingletonContent;\n        },\n        cleanup() {\n          mutableBox.sourceData = null;\n        },\n      };\n\n      const target = {\n        hook(data) {\n          mutableBox.children = mutableBox.children.filter(\n            ({instance}) => data.instance !== instance,\n          );\n          mutableBox.children.push(data);\n\n          if (\n            mutableBox.instance?.state.isMounted &&\n            mutableBox.instance?.state.$$activeSingletonInstance ===\n              data.instance\n          ) {\n            mutableBox.setSingletonContent?.(data.content);\n          }\n\n          if (mutableBox.instance && !mutableBox.instance.state.isDestroyed) {\n            mutableBox.instance.setInstances(\n              mutableBox.children.map(child => child.instance),\n            );\n          }\n        },\n        cleanup(instance) {\n          mutableBox.children = mutableBox.children.filter(\n            data => data.instance !== instance,\n          );\n\n          if (mutableBox.instance && !mutableBox.instance.state.isDestroyed) {\n            mutableBox.instance.setInstances(\n              mutableBox.children.map(child => child.instance),\n            );\n          }\n        },\n      };\n\n      return [source, target];\n    }, []);\n  };\n}\n","import React, {cloneElement, forwardRef} from 'react';\nimport {preserveRef} from './utils';\n\nexport default (Tippy, defaultProps) =>\n  forwardRef(function TippyWrapper({children, ...props}, ref) {\n    return (\n      // If I spread them separately here, Babel adds the _extends ponyfill for\n      // some reason\n      <Tippy {...{...defaultProps, ...props}}>\n        {children\n          ? cloneElement(children, {\n              ref(node) {\n                preserveRef(ref, node);\n                preserveRef(children.ref, node);\n              },\n            })\n          : null}\n      </Tippy>\n    );\n  });\n","import tippy, {createSingleton} from 'tippy.js';\nimport TippyGenerator from './Tippy';\nimport useSingletonGenerator from './useSingleton';\nimport forwardRef from './forwardRef';\n\nconst useSingleton = useSingletonGenerator(createSingleton);\n\nexport default forwardRef(TippyGenerator(tippy));\nexport {useSingleton, tippy};\n"],"names":["isBrowser","window","document","preserveRef","ref","node","hasOwnProperty","call","current","ssrSafeCreateDiv","createElement","toDataAttributes","attrs","dataAttrs","placement","referenceHidden","escaped","deepEqual","x","y","Object","keys","length","prop","uniqueByShape","arr","output","forEach","item","find","outputItem","push","deepPreserveProps","instanceProps","componentProps","popperOptions","modifiers","useMutableBox","initialValue","useRef","updateClassName","box","action","classNames","split","name","classList","classNamePlugin","defaultValue","fn","instance","popper","firstElementChild","isDefaultRenderFn","props","render","$$tippy","add","className","process","env","NODE_ENV","console","warn","join","remove","onCreate","onBeforeUpdate","onAfterUpdate","TippyGenerator","tippy","Tippy","children","content","visible","singleton","reference","disabled","ignoreAttributes","__source","__self","restOfNativeProps","isControlledMode","undefined","isSingletonMode","useState","mounted","setMounted","setAttrs","singletonContent","setSingletonContent","mutableBox","container","renders","nativeStateProp","trigger","hideOnClick","computedProps","plugins","data","onTrigger","event","currentTarget","state","$$activeSingletonInstance","deps","concat","type","useEffect","element","disable","show","hook","destroy","cleanup","setProps","popperInstance","forceUpdate","enable","hide","filter","enabled","phase","requires","hideData","modifiersData","isReferenceHidden","hasPopperEscaped","attributes","React","cloneElement","createPortal","useSingletonGenerator","createSingleton","useSingleton","overrides","sourceData","error","map","child","isDestroyed","setInstances","useMemo","source","target","isMounted","defaultProps","forwardRef","TippyWrapper"],"mappings":"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"}